<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Apply — GroupWeb</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<style>
		body { font-family: Arial, Helvetica, sans-serif; margin: 2em; background: #f9f9f9; }
		main { max-width: 760px; margin: 0 auto; background: #fff; padding: 1.5rem; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
		label { display: block; margin-top: 0.75rem; }
		input[type="text"], input[type="email"], input[type="date"], select, textarea { width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px; }
		.two-col { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; }
		.small { width: 160px; }
		fieldset { margin-top: 0.75rem; padding: 0.75rem; border-radius: 6px; }
		.checkboxes { display: flex; gap: 0.5rem; flex-wrap: wrap; }
		.error { color: #b00020; font-size: 0.9rem; }
		.submit-row { margin-top: 1rem; }
		button { background: #0078d4; color: white; border: none; padding: 0.6rem 1rem; border-radius: 6px; cursor: pointer; }
	</style>
</head>
<body>
	<main>
		<h1>Job Application</h1>
		<p>Please complete the form below to register your interest in the advertised position. Fields marked with * are required.</p>

	<form id="applicationForm" method="post" action="https://mercury.swin.edu.au/it000000/formtest.php" novalidate>
			<label for="jobRef">Job reference number *</label>
			<select id="jobRef" name="jobRef" required>
				<option value="" disabled selected>Select a job...</option>
				<option value="CYB-001">CYB-001 — Cybersecurity Specialist</option>
				<option value="UIX-002">UIX-002 — UI/UX Designer</option>
			</select>

			<div class="two-col">
				<div>
					<label for="firstName">First name * (max 20 letters)</label>
					<input id="firstName" name="firstName" type="text" maxlength="20" pattern="^[A-Za-z]+$" required title="Enter up to 20 alphabetic characters">
				</div>
				<div>
					<label for="lastName">Last name * (max 20 letters)</label>
					<input id="lastName" name="lastName" type="text" maxlength="20" pattern="^[A-Za-z]+$" required title="Enter up to 20 alphabetic characters">
				</div>
			</div>

			<label for="dob">Date of birth * (dd/mm/yyyy)</label>
			<!-- use text input with pattern since HTML date control shows yyyy-mm-dd in some browsers -->
			<input id="dob" name="dob" type="text" placeholder="dd/mm/yyyy" pattern="^(0[1-9]|[12][0-9]|3[01])\/(0[1-9]|1[0-2])\/(19|20)\d\d$" required title="Enter date as dd/mm/yyyy">

			<fieldset>
				<legend>Gender *</legend>
				<label><input type="radio" name="gender" value="female" required> Female</label>
				<label><input type="radio" name="gender" value="male"> Male</label>
				<label><input type="radio" name="gender" value="other"> Other</label>
			</fieldset>

			<label for="street">Street Address * (max 40 chars)</label>
			<input id="street" name="street" type="text" maxlength="40" required>

			<label for="suburb">Suburb/Town * (max 40 chars)</label>
			<input id="suburb" name="suburb" type="text" maxlength="40" required>

			<div class="two-col">
				<div>
					<label for="state">State *</label>
					<select id="state" name="state" required>
						<option value="" disabled selected>Select state</option>
						<option value="VIC">VIC</option>
						<option value="NSW">NSW</option>
						<option value="QLD">QLD</option>
						<option value="NT">NT</option>
						<option value="WA">WA</option>
						<option value="SA">SA</option>
						<option value="TAS">TAS</option>
						<option value="ACT">ACT</option>
					</select>
				</div>
				<div>
					<label for="postcode">Postcode * (4 digits)</label>
					<input id="postcode" name="postcode" type="text" pattern="^\d{4}$" maxlength="4" required title="Enter a 4-digit postcode">
				</div>
			</div>

			<label for="email">Email address *</label>
			<input id="email" name="email" type="email" required pattern="^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$" title="Enter a valid email address">

			<label for="phone">Phone number * (8 to 12 digits, spaces allowed)</label>
			<input id="phone" name="phone" type="text" required pattern="^[0-9 ]{8,12}$" title="Enter 8 to 12 digits or spaces">

			<fieldset>
				<legend>Required technical skills *</legend>
				<div class="checkboxes" id="techSkills">
					<label><input type="checkbox" name="skills" value="html" required> HTML</label>
					<label><input type="checkbox" name="skills" value="css"> CSS</label>
					<label><input type="checkbox" name="skills" value="js"> JavaScript</label>
					<label><input type="checkbox" name="skills" value="sec"> Security</label>
				</div>
			</fieldset>

			<label for="other">Other skills (optional)</label>
			<textarea id="other" name="other" rows="4" placeholder="List other skills or notes (optional)"></textarea>

			<div class="submit-row">
				<button type="submit">Apply</button>
				<div id="formError" class="error" aria-live="polite"></div>
			</div>
		</form>

		<script>
			// Validate that at least one skills checkbox is checked (HTML required on one won't work across group)
			const form = document.getElementById('applicationForm');
			const skills = document.querySelectorAll('#techSkills input[type="checkbox"]');
			const state = document.getElementById('state');
			const postcode = document.getElementById('postcode');
			const formError = document.getElementById('formError');

			function statePostcodeMatches(stateVal, pc) {
				// Basic mapping for Australian postcodes by first digit ranges
				// VIC (3,8), NSW (1,2), QLD (4,9), NT (0), WA (6), SA (5), TAS (7), ACT (0,2)
				if (!pc || pc.length !== 4) return false;
				const first = pc.charAt(0);
				switch(stateVal) {
					case 'VIC': return ['3','8'].includes(first);
					case 'NSW': return ['1','2'].includes(first);
					case 'QLD': return ['4','9'].includes(first);
					case 'NT': return first === '0';
					case 'WA': return first === '6';
					case 'SA': return first === '5';
					case 'TAS': return first === '7';
					case 'ACT': return ['0','2'].includes(first);
					default: return true;
				}
			}

			form.addEventListener('submit', function(e) {
				formError.textContent = '';
				// Use HTML5 validity first
				if (!form.checkValidity()) {
					form.reportValidity();
					e.preventDefault();
					return;
				}

				// Check skills at least one checked
				const anySkill = Array.from(skills).some(ch => ch.checked);
				if (!anySkill) {
					formError.textContent = 'Please select at least one required technical skill.';
					e.preventDefault();
					return;
				}

				// Check postcode/state matching
				const st = state.value;
				const pc = postcode.value.trim();
				if (!statePostcodeMatches(st, pc)) {
					formError.textContent = 'Postcode does not match selected state.';
					e.preventDefault();
					return;
				}

				// All checks pass — allow the form to submit via POST to the server action.
				// Do not call preventDefault() here so the browser will send the POST request.
				formError.textContent = '';
				return; // allow default submit to proceed
			});
		</script>
	</main>
</body>
</html>

